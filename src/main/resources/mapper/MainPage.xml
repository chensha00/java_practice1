<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.4//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Entity.MainPage">

    <resultMap id="mainPage" type="Entity.MainPage">
        <result property="invertoryId" column="ID" jdbcType="BIGINT" javaType="java.lang.Long"/>
        <result property="price" column="PRICE" jdbcType="DECIMAL" javaType="java.lang.Double"/>
        <result property="number" column="NUMBER" jdbcType="DOUBLE" javaType="java.lang.Double"/>
        <result property="name" column="NAME" jdbcType="VARCHAR" javaType="java.lang.String"/>
        <result property="storeName" column="STORE_NAME" jdbcType="VARCHAR" javaType="java.lang.String"/>
    </resultMap>

    <!--查询所有显示的数据-->
    <select id="findMainPageInvertoryAll" resultType="java.util.Map" resultMap="mainPage">
        SELECT
        invertory.ID,PRICE,NUMBER,NAME,STORE_NAME
        FROM GOODS,STORE,INVERTORY
        WHERE INVERTORY.STORE_ID = STORE.ID
        AND INVERTORY.GOODS_ID = GOODS.ID
        AND NUMBER > 0
        GROUP BY INVERTORY.ID
    </select>

    <!--查询指定分页显示的数据-->
    <select id="findMainPageInvertory" resultType="java.util.Map" resultMap="mainPage">
        SELECT
        invertory.ID,PRICE,NUMBER,NAME,STORE_NAME
        FROM GOODS,STORE,INVERTORY
        WHERE INVERTORY.STORE_ID = STORE.ID
        AND INVERTORY.GOODS_ID = GOODS.ID
        AND NUMBER > 0
        GROUP BY INVERTORY.ID
        LIMIT #{start},#{end}
    </select>

    <!--条件查询-->
    <select id="findMainPageCondition" resultType="java.util.Map" resultMap="mainPage">
        SELECT
        invertory.ID,PRICE,NUMBER,NAME,STORE_NAME
        FROM GOODS,STORE,INVERTORY
        WHERE INVERTORY.STORE_ID = STORE.ID
        AND INVERTORY.GOODS_ID = GOODS.ID
        AND NUMBER > 0
        AND NAME LIKE CONCAT('%',#{condition},'%')
		OR STORE_NAME LIKE CONCAT('%',#{condition},'%')
        GROUP BY invertory.ID
    </select>


</mapper>