<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.4//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="domain.Invertory">
    <!--定义结果集-->
    <resultMap id="invertory" type="domain.Invertory">
        <id property="id" column="ID" jdbcType="BIGINT" javaType="java.lang.Long"/>
        <result property="storeId" column="STORE_ID" jdbcType="BIGINT" javaType="java.lang.Long"/>
        <result property="goodsId" column="GOODS_ID" jdbcType="BIGINT" javaType="java.lang.Long"/>
        <result property="price" column="PRICE" jdbcType="DECIMAL" javaType="java.lang.Double"/>
        <result property="number" column="NUMBER" jdbcType="DOUBLE" javaType="java.lang.Double"/>
    </resultMap>

    <!--sql语句-->
    <sql id="invertorySql">
        ID,STORE_ID,GOODS_ID,PRICE,NUMBER
    </sql>
    <!--根据ID查询-->
    <select id="findInvertoryById" resultMap="invertory">
        SELECT
        <include refid="invertorySql"/>
        FROM INVERTORY
        WHERE ID=#{id}
    </select>
    <!--查询所有-->
    <select id="findInvertoryAll" resultMap="invertory">
        SELECT
        <include refid="invertorySql"/>
        FROM INVERTORY
        GROUP BY ID
    </select>
    <!--根据店铺ID和商品ID查询库存-->
    <select id="findInvertoryByStoreIdAndGoodsId" resultMap="invertory">
        SELECT
        <include refid="invertorySql"/>
        FROM INVERTORY
        WHERE STORE_ID=#{storeId,jdbcType=BIGINT}
        AND GOODS_ID=#{goodsId,jdbcType=BIGINT}
    </select>

    <!--根据店铺ID查询店铺所有库存-->
    <select id="findInvertoryByUnSureCondition" resultMap="invertory">
        SELECT
        <include refid="invertorySql"/>
        FROM INVERTORY WHERE 1=1
        <foreach collection="list" item="map">
            AND ${map.name} ${map.rela} ${map.value}
        </foreach>
    </select>


    <!--添加-->
    <insert id="saveInvertory">
        INSERT INTO INVERTORY(ID,STORE_ID,GOODS_ID,PRICE,NUMBER) VALUES(DEFAULT,
        ${invertory.storeId},${invertory.goodsId},${invertory.price},${invertory.number})
    </insert>
    <!--根据ID删除-->
    <delete id="deleteInvertoryById">
        DELETE FROM INVERTORY WHERE ID=#{id}
    </delete>
    <!--根据ID进行修改-->
    <update id="updateInvertorById" parameterType="java.util.Map">
         UPDATE INVERTORY SET STORE_ID=${invertory.storeId},GOODS_ID=${invertory.goodsId},
         PRICE=${invertory.price},NUMBER=${invertory.number} WHERE ID=#{id};
    </update>

</mapper>